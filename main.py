import asyncio
import csv
import os
from playwright.async_api import async_playwright

LIST = ['https://www.facebook.com/61553089337444/', 'https://www.facebook.com/61553382547729/', 'https://www.facebook.com/61553452568154/', 'https://www.facebook.com/61553500532157/', 'https://www.facebook.com/61553588743804/', 'https://www.facebook.com/61553627278788/', 'https://www.facebook.com/61553653064430/', 'https://www.facebook.com/61553683233036/', 'https://www.facebook.com/61553843641726/', 'https://www.facebook.com/61553866645619/', 'https://www.facebook.com/61553937444701/', 'https://www.facebook.com/61553996548084/', 'https://www.facebook.com/61554104607350/', 'https://www.facebook.com/61554179796798/', 'https://www.facebook.com/61554182199439/', 'https://www.facebook.com/61554206746232/', 'https://www.facebook.com/61554220195708/', 'https://www.facebook.com/61554225546042/', 'https://www.facebook.com/61554338220087/', 'https://www.facebook.com/61554348065308/', 'https://www.facebook.com/61554572161912/', 'https://www.facebook.com/61554699407445/', 'https://www.facebook.com/61554888097679/', 'https://www.facebook.com/61554904780162/', 'https://www.facebook.com/61554939342836/', 'https://www.facebook.com/61554951420979/', 'https://www.facebook.com/61554996373492/', 'https://www.facebook.com/61555192206126/', 'https://www.facebook.com/61555271070775/', 'https://www.facebook.com/61555321946082/', 'https://www.facebook.com/61555352084447/', 'https://www.facebook.com/61555355960926/', 'https://www.facebook.com/61555467077674/', 'https://www.facebook.com/61555509637770/', 'https://www.facebook.com/61555511153385/', 'https://www.facebook.com/61555756002328/', 'https://www.facebook.com/61555771859223/', 'https://www.facebook.com/61555838757152/', 'https://www.facebook.com/61555938374346/', 'https://www.facebook.com/61556075106810/', 'https://www.facebook.com/61556252820774/', 'https://www.facebook.com/61556365720309/', 'https://www.facebook.com/61556388603996/', 'https://www.facebook.com/61556404928593/', 'https://www.facebook.com/61556441140745/', 'https://www.facebook.com/61556512268345/', 'https://www.facebook.com/61556516356676/', 'https://www.facebook.com/61556545695663/', 'https://www.facebook.com/61556606425687/', 'https://www.facebook.com/61556692355328/', 'https://www.facebook.com/61556783766131/', 'https://www.facebook.com/61556802243858/', 'https://www.facebook.com/61556897368236/', 'https://www.facebook.com/61556908934573/', 'https://www.facebook.com/61556943592307/', 'https://www.facebook.com/61556944348643/', 'https://www.facebook.com/61556970260083/', 'https://www.facebook.com/61556990399278/', 'https://www.facebook.com/61557005314622/', 'https://www.facebook.com/61557027550881/', 'https://www.facebook.com/61557097858393/', 'https://www.facebook.com/61557129864251/', 'https://www.facebook.com/61557213677434/', 'https://www.facebook.com/61557373882606/', 'https://www.facebook.com/61557422551426/', 'https://www.facebook.com/61557427126009/', 'https://www.facebook.com/61557441268909/', 'https://www.facebook.com/61557539686170/', 'https://www.facebook.com/61557552824429/', 'https://www.facebook.com/61557576234591/', 'https://www.facebook.com/61557607514978/', 'https://www.facebook.com/61557610660326/', 'https://www.facebook.com/61557629956705/', 'https://www.facebook.com/61557709443948/', 'https://www.facebook.com/61557746175832/', 'https://www.facebook.com/61557809307249/', 'https://www.facebook.com/61557872613119/', 'https://www.facebook.com/61557922019910/', 'https://www.facebook.com/61557951986302/', 'https://www.facebook.com/61557952747433/', 'https://www.facebook.com/61557956730859/', 'https://www.facebook.com/61558014821150/', 'https://www.facebook.com/61558043318194/', 'https://www.facebook.com/61558061932513/', 'https://www.facebook.com/61558098072232/', 'https://www.facebook.com/61558112297173/', 'https://www.facebook.com/61558151001619/', 'https://www.facebook.com/61558217587451/', 'https://www.facebook.com/61558254629296/', 'https://www.facebook.com/61558254872638/', 'https://www.facebook.com/61558257809384/', 'https://www.facebook.com/61558316127826/', 'https://www.facebook.com/61558398964161/', 'https://www.facebook.com/61558431338598/', 'https://www.facebook.com/61558474820321/', 'https://www.facebook.com/61558492383515/', 'https://www.facebook.com/61558500703321/', 'https://www.facebook.com/61558522824766/', 'https://www.facebook.com/61558528315941/', 'https://www.facebook.com/61558530813295/', 'https://www.facebook.com/61558533060522/', 'https://www.facebook.com/61558558464806/', 'https://www.facebook.com/61558619505501/', 'https://www.facebook.com/61558658408099/', 'https://www.facebook.com/61558718311318/', 'https://www.facebook.com/61558720449735/', 'https://www.facebook.com/61558845805789/', 'https://www.facebook.com/61558877114355/', 'https://www.facebook.com/61558939475324/', 'https://www.facebook.com/61559043314402/', 'https://www.facebook.com/61559083740492/', 'https://www.facebook.com/61559083840074/', 'https://www.facebook.com/61559089393293/', 'https://www.facebook.com/61559255331780/', 'https://www.facebook.com/61559349904773/', 'https://www.facebook.com/61559371890965/', 'https://www.facebook.com/61559422571229/', 'https://www.facebook.com/61559428173008/', 'https://www.facebook.com/61559479721159/', 'https://www.facebook.com/61559503228513/', 'https://www.facebook.com/61559530199475/', 'https://www.facebook.com/61559575421222/', 'https://www.facebook.com/61559583636146/', 'https://www.facebook.com/61559588315804/', 'https://www.facebook.com/61559651941327/', 'https://www.facebook.com/61559652416012/', 'https://www.facebook.com/61559745191069/', 'https://www.facebook.com/61559747762159/', 'https://www.facebook.com/61559781326559/', 'https://www.facebook.com/61559829567310/', 'https://www.facebook.com/61559920793293/', 'https://www.facebook.com/61559926653281/', 'https://www.facebook.com/61559940249523/', 'https://www.facebook.com/61559942333122/', 'https://www.facebook.com/61559960172872/', 'https://www.facebook.com/61559983820642/', 'https://www.facebook.com/61559984799056/', 'https://www.facebook.com/61559995778794/', 'https://www.facebook.com/61560014769150/', 'https://www.facebook.com/61560083033278/', 'https://www.facebook.com/61560128433255/', 'https://www.facebook.com/61560177407363/', 'https://www.facebook.com/61560204964295/', 'https://www.facebook.com/61560255571934/', 'https://www.facebook.com/61560292931331/', 'https://www.facebook.com/61560295121675/', 'https://www.facebook.com/61560361950237/', 'https://www.facebook.com/61560417946740/', 'https://www.facebook.com/61560422429717/', 'https://www.facebook.com/61560451342993/', 'https://www.facebook.com/61560451715607/', 'https://www.facebook.com/61560575594564/', 'https://www.facebook.com/61560602831803/', 'https://www.facebook.com/61560659984227/', 'https://www.facebook.com/61560703596304/', 'https://www.facebook.com/61560850837663/', 'https://www.facebook.com/61560916026126/', 'https://www.facebook.com/61560962489265/', 'https://www.facebook.com/61560964899664/', 'https://www.facebook.com/61561092695680/', 'https://www.facebook.com/61561098818049/', 'https://www.facebook.com/61561101957800/', 'https://www.facebook.com/61561134211811/', 'https://www.facebook.com/61561148472533/', 'https://www.facebook.com/61561191142753/', 'https://www.facebook.com/61561241315716/', 'https://www.facebook.com/61561242338908/', 'https://www.facebook.com/61561254260434/', 'https://www.facebook.com/61561303077890/', 'https://www.facebook.com/61561349553505/', 'https://www.facebook.com/61561350930514/', 'https://www.facebook.com/61561359388191/', 'https://www.facebook.com/61561390170978/', 'https://www.facebook.com/61561442039007/', 'https://www.facebook.com/61561603857507/', 'https://www.facebook.com/61561613875937/', 'https://www.facebook.com/61561630770667/', 'https://www.facebook.com/61561649081662/', 'https://www.facebook.com/61561676496829/', 'https://www.facebook.com/61561821122776/', 'https://www.facebook.com/61561821127573/', 'https://www.facebook.com/61561829259208/', 'https://www.facebook.com/61561904874072/', 'https://www.facebook.com/61561999954130/', 'https://www.facebook.com/61562010915092/', 'https://www.facebook.com/61562058103076/', 'https://www.facebook.com/61562123142692/', 'https://www.facebook.com/61562268507133/', 'https://www.facebook.com/61562313239820/', 'https://www.facebook.com/61562346122574/', 'https://www.facebook.com/61562399712579/', 'https://www.facebook.com/61562581551689/', 'https://www.facebook.com/61562596575579/', 'https://www.facebook.com/61562597207427/', 'https://www.facebook.com/61562911933307/', 'https://www.facebook.com/61563028498440/', 'https://www.facebook.com/61563056917041/', 'https://www.facebook.com/61563064646951/', 'https://www.facebook.com/61563130916477/', 'https://www.facebook.com/61563312153082/', 'https://www.facebook.com/61563349803471/', 'https://www.facebook.com/61563364421365/', 'https://www.facebook.com/61563388804822/', 'https://www.facebook.com/61563428417276/', 'https://www.facebook.com/61563452082947/', 'https://www.facebook.com/61563605828293/', 'https://www.facebook.com/61563610154425/', 'https://www.facebook.com/61563754124801/', 'https://www.facebook.com/61564003963045/', 'https://www.facebook.com/61564150757351/', 'https://www.facebook.com/61564269433853/', 'https://www.facebook.com/61564403075565/', 'https://www.facebook.com/61564442616882/', 'https://www.facebook.com/61564588487280/', 'https://www.facebook.com/61564631122113/', 'https://www.facebook.com/61564665284261/', 'https://www.facebook.com/61564679055037/', 'https://www.facebook.com/61564752450460/', 'https://www.facebook.com/61564811489899/', 'https://www.facebook.com/61564846061100/', 'https://www.facebook.com/61564854096889/', 'https://www.facebook.com/61564861272054/', 'https://www.facebook.com/61564877926049/', 'https://www.facebook.com/61564880562028/', 'https://www.facebook.com/61564889679272/', 'https://www.facebook.com/61564928814401/', 'https://www.facebook.com/61564938912758/', 'https://www.facebook.com/61565071270585/', 'https://www.facebook.com/61565076029492/', 'https://www.facebook.com/61565085024400/', 'https://www.facebook.com/61565088188796/', 'https://www.facebook.com/61565207090502/', 'https://www.facebook.com/61565282600002/', 'https://www.facebook.com/61565314764305/', 'https://www.facebook.com/61565345230924/', 'https://www.facebook.com/61565349343288/', 'https://www.facebook.com/61565389270093/', 'https://www.facebook.com/61565408137582/', 'https://www.facebook.com/61565428545898/', 'https://www.facebook.com/61565522732043/', 'https://www.facebook.com/61565654551313/', 'https://www.facebook.com/61565721123774/', 'https://www.facebook.com/61565773003774/', 'https://www.facebook.com/61565871180873/', 'https://www.facebook.com/61565893239803/', 'https://www.facebook.com/61565916580136/', 'https://www.facebook.com/61565947096778/', 'https://www.facebook.com/61565969335569/', 'https://www.facebook.com/61565983678669/', 'https://www.facebook.com/61565985538023/', 'https://www.facebook.com/61565986150887/', 'https://www.facebook.com/61566115542622/', 'https://www.facebook.com/61566118173612/', 'https://www.facebook.com/61566126523657/', 'https://www.facebook.com/61566127332036/', 'https://www.facebook.com/61566134613355/', 'https://www.facebook.com/61566135215390/', 'https://www.facebook.com/61566139979317/', 'https://www.facebook.com/61566159620468/', 'https://www.facebook.com/61566167169251/', 'https://www.facebook.com/61566167813625/', 'https://www.facebook.com/61566306322063/', 'https://www.facebook.com/61566317712388/', 'https://www.facebook.com/61566327727207/', 'https://www.facebook.com/61566337395085/', 'https://www.facebook.com/61566342268097/', 'https://www.facebook.com/61566343584637/', 'https://www.facebook.com/61566363901062/', 'https://www.facebook.com/61566406373629/', 'https://www.facebook.com/61566484040714/', 'https://www.facebook.com/61566514392344/', 'https://www.facebook.com/61566534151555/', 'https://www.facebook.com/61566536338678/', 'https://www.facebook.com/61566588050080/', 'https://www.facebook.com/61566601344990/', 'https://www.facebook.com/61566603847729/', 'https://www.facebook.com/61566618883588/', 'https://www.facebook.com/61566664811050/', 'https://www.facebook.com/61566665871072/', 'https://www.facebook.com/61566736743144/', 'https://www.facebook.com/61566753546367/', 'https://www.facebook.com/61566758044498/', 'https://www.facebook.com/61566782626932/', 'https://www.facebook.com/61566791039850/', 'https://www.facebook.com/61566845067758/', 'https://www.facebook.com/61566973910238/', 'https://www.facebook.com/61566976620604/', 'https://www.facebook.com/61567013836070/', 'https://www.facebook.com/61567067195964/', 'https://www.facebook.com/61567093893272/', 'https://www.facebook.com/61567127947492/', 'https://www.facebook.com/61567136706244/', 'https://www.facebook.com/61567149706682/', 'https://www.facebook.com/61567242389911/', 'https://www.facebook.com/61567258558430/', 'https://www.facebook.com/61567279165048/', 'https://www.facebook.com/61567285730596/', 'https://www.facebook.com/61567306706319/', 'https://www.facebook.com/61567325649133/', 'https://www.facebook.com/61567344308205/', 'https://www.facebook.com/61567355885072/', 'https://www.facebook.com/61567552131093/', 'https://www.facebook.com/61567665144158/', 'https://www.facebook.com/61567675340537/', 'https://www.facebook.com/61567707248807/', 'https://www.facebook.com/61567714843451/', 'https://www.facebook.com/61567777903596/', 'https://www.facebook.com/61567859704244/', 'https://www.facebook.com/61567884473486/', 'https://www.facebook.com/61568076891001/', 'https://www.facebook.com/61568099528051/', 'https://www.facebook.com/61568152853208/', 'https://www.facebook.com/61568229487845/', 'https://www.facebook.com/61568293921766/', 'https://www.facebook.com/61568389905881/', 'https://www.facebook.com/61568394479725/', 'https://www.facebook.com/61568398777583/', 'https://www.facebook.com/61568411853235/', 'https://www.facebook.com/61568498189002/', 'https://www.facebook.com/61568618905222/', 'https://www.facebook.com/61568636949901/', 'https://www.facebook.com/61568642117559/', 'https://www.facebook.com/61568667160975/', 'https://www.facebook.com/61568702159533/', 'https://www.facebook.com/61568780667177/', 'https://www.facebook.com/61568804606206/', 'https://www.facebook.com/61568807651409/', 'https://www.facebook.com/61568978349528/', 'https://www.facebook.com/61569012465798/', 'https://www.facebook.com/61569021332414/', 'https://www.facebook.com/61569028173210/', 'https://www.facebook.com/61569097051743/', 'https://www.facebook.com/61569130749743/', 'https://www.facebook.com/61569181384055/', 'https://www.facebook.com/61569186042874/', 'https://www.facebook.com/61569294509957/', 'https://www.facebook.com/61569302081391/', 'https://www.facebook.com/61569364355862/', 'https://www.facebook.com/61569418454654/', 'https://www.facebook.com/61569420548962/', 'https://www.facebook.com/61569557831933/', 'https://www.facebook.com/61569572820378/', 'https://www.facebook.com/61569651669576/', 'https://www.facebook.com/61569710496474/', 'https://www.facebook.com/61569827630318/', 'https://www.facebook.com/61569856378157/', 'https://www.facebook.com/61569961321415/', 'https://www.facebook.com/61570056519763/', 'https://www.facebook.com/61570103212397/', 'https://www.facebook.com/61570136401938/', 'https://www.facebook.com/61570205167743/', 'https://www.facebook.com/61570209777291/', 'https://www.facebook.com/61570230494650/', 'https://www.facebook.com/61570233254895/', 'https://www.facebook.com/61570234330238/', 'https://www.facebook.com/61570307594106/', 'https://www.facebook.com/61570367319735/', 'https://www.facebook.com/61570416807776/', 'https://www.facebook.com/61570437023264/', 'https://www.facebook.com/61570488327368/', 'https://www.facebook.com/61570491565304/', 'https://www.facebook.com/61570529424940/', 'https://www.facebook.com/61570536098659/', 'https://www.facebook.com/61570568678852/', 'https://www.facebook.com/61570602038345/', 'https://www.facebook.com/61570606801885/', 'https://www.facebook.com/61570612088230/', 'https://www.facebook.com/61570755883385/', 'https://www.facebook.com/61570789092712/', 'https://www.facebook.com/61570834150128/', 'https://www.facebook.com/61570855827378/', 'https://www.facebook.com/61570869620044/', 'https://www.facebook.com/61570912526164/', 'https://www.facebook.com/61570912806097/', 'https://www.facebook.com/61570931423413/', 'https://www.facebook.com/61570962684231/', 'https://www.facebook.com/61570987553348/', 'https://www.facebook.com/61571011177717/', 'https://www.facebook.com/61571086282553/', 'https://www.facebook.com/61571112791720/', 'https://www.facebook.com/61571127045770/', 'https://www.facebook.com/61571171982839/', 'https://www.facebook.com/61571301634205/', 'https://www.facebook.com/61571325543582/', 'https://www.facebook.com/61571327466545/', 'https://www.facebook.com/61571368423017/', 'https://www.facebook.com/61571432337863/', 'https://www.facebook.com/61571432546825/', 'https://www.facebook.com/61571461216631/', 'https://www.facebook.com/61571464030410/', 'https://www.facebook.com/61571477102855/', 'https://www.facebook.com/61571484037224/', 'https://www.facebook.com/61571487225164/', 'https://www.facebook.com/61571567254723/', 'https://www.facebook.com/61571573491221/', 'https://www.facebook.com/61571585845305/', 'https://www.facebook.com/61571594223172/', 'https://www.facebook.com/61571598556014/', 'https://www.facebook.com/61571599856536/', 'https://www.facebook.com/61571631585462/', 'https://www.facebook.com/61571638112462/', 'https://www.facebook.com/61571641974513/', 'https://www.facebook.com/61571648461237/', 'https://www.facebook.com/61571658915832/', 'https://www.facebook.com/61571669696277/', 'https://www.facebook.com/61571691638321/', 'https://www.facebook.com/61571739883854/', 'https://www.facebook.com/61571762790836/', 'https://www.facebook.com/61571803937112/', 'https://www.facebook.com/61571854813951/', 'https://www.facebook.com/61571858624123/', 'https://www.facebook.com/61571886644281/', 'https://www.facebook.com/61571900653454/', 'https://www.facebook.com/61571943581523/', 'https://www.facebook.com/61571960005254/', 'https://www.facebook.com/61571993294469/', 'https://www.facebook.com/61572017524373/', 'https://www.facebook.com/61572022880714/', 'https://www.facebook.com/61572026521655/', 'https://www.facebook.com/61572047234935/', 'https://www.facebook.com/61572214556193/', 'https://www.facebook.com/61572246017494/', 'https://www.facebook.com/61572287127839/', 'https://www.facebook.com/61572317074371/', 'https://www.facebook.com/61572335652659/', 'https://www.facebook.com/61572349600874/', 'https://www.facebook.com/61572381892649/', 'https://www.facebook.com/61572389240024/', 'https://www.facebook.com/61572410634662/', 'https://www.facebook.com/61572415180986/', 'https://www.facebook.com/61572420453890/', 'https://www.facebook.com/61572427165051/', 'https://www.facebook.com/61572460271031/', 'https://www.facebook.com/61572486357158/', 'https://www.facebook.com/61572490536151/', 'https://www.facebook.com/61572494063437/', 'https://www.facebook.com/61572526562791/', 'https://www.facebook.com/61572526685121/', 'https://www.facebook.com/61572538100933/', 'https://www.facebook.com/61572549177920/', 'https://www.facebook.com/61572557234077/', 'https://www.facebook.com/61572561034109/', 'https://www.facebook.com/61572590712726/', 'https://www.facebook.com/61572597957926/', 'https://www.facebook.com/61572606808080/', 'https://www.facebook.com/61572631265303/', 'https://www.facebook.com/61572643412423/', 'https://www.facebook.com/61572685393493/', 'https://www.facebook.com/61572710195160/', 'https://www.facebook.com/61572739540455/', 'https://www.facebook.com/61572780584984/', 'https://www.facebook.com/61572815423340/', 'https://www.facebook.com/61572836195469/', 'https://www.facebook.com/61572869257392/', 'https://www.facebook.com/61572879864202/', 'https://www.facebook.com/61572893334531/', 'https://www.facebook.com/61572919621857/', 'https://www.facebook.com/61572920595653/', 'https://www.facebook.com/61572926678468/', 'https://www.facebook.com/61572930120223/', 'https://www.facebook.com/61572950665681/', 'https://www.facebook.com/61572954445558/', 'https://www.facebook.com/61572972269548/', 'https://www.facebook.com/61572974587945/', 'https://www.facebook.com/61572998521519/', 'https://www.facebook.com/61572999966534/']


phone_list = set()
chunk_size = 100
semaphore = asyncio.Semaphore(8)

# Load existing numbers from CSV to prevent duplicates
if os.path.exists("phones.csv"):
    with open("phones.csv", newline="") as f:
        reader = csv.reader(f)
        phone_list.update(row[0] for row in reader)

async def process_url(browser, url):
    async with semaphore:
        page = await browser.new_page()
        try:
            await page.goto(url)
            try:
                await page.click("div[aria-label='Close']", timeout=3000)
            except:
                pass
            await page.wait_for_selector("div[role='main']")
            await page.wait_for_timeout(3000)
            phone_element = page.locator("text=/\\+?[0-9][0-9\\-\\s]{8,}/").first
            if await phone_element.count() > 0:
                raw = await phone_element.inner_text()
                cleaned = raw.replace(" ", "")
                if cleaned not in phone_list:
                    phone_list.add(cleaned)
                    with open("phones.csv", "a", newline="") as f:
                        writer = csv.writer(f)
                        writer.writerow([cleaned])
        except:
            pass
        finally:
            await page.close()
            LIST.remove(url)

async def go():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        tasks = [process_url(browser, url) for url in LIST[:chunk_size]]
        await asyncio.gather(*tasks)
        await browser.close()

asyncio.run(go())
